<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <meta name="description"
        content="Under consutrction.">
  <meta name="keywords" content="Offline RL, Goal-Conditioned RL">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>How Far I'll Go: Offline Goal-Conditioned RL via F-Advantage Regression</title>

  </script>

  <link href="https://fonts.googleapis.com/css?family=Google+Sans|Noto+Sans|Castoro"
        rel="stylesheet">

  <link rel="stylesheet" href="./static/css/bulma.min.css">
  <link rel="stylesheet" href="./static/css/bulma-carousel.min.css">
  <link rel="stylesheet" href="./static/css/bulma-slider.min.css">
  <link rel="stylesheet" href="./static/css/fontawesome.all.min.css">
  <link rel="stylesheet"
        href="https://cdn.jsdelivr.net/gh/jpswalsh/academicons@1/css/academicons.min.css">
  <link rel="stylesheet" href="./static/css/index.css">

  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
  <script defer src="./static/js/fontawesome.all.min.js"></script>
  <script src="./static/js/bulma-carousel.min.js"></script>
  <script src="./static/js/bulma-slider.min.js"></script>
  <script src="./static/js/index.js"></script>
</head>
<body>


<section class="hero">
  <div class="hero-body">
    <div class="container is-max-widescreen">
      <div class="columns is-centered">
        <div class="column has-text-centered">
          <h1 class="title is-1 publication-title" style="font-size:38px">How Far I'll Go:<br>Offline Goal-Conditioned RL via <br>F-Advantage Regression</h1>
          <!-- <h1 class="title is-1 publication-title" style="font-size:25px">ICML 2022</h1> -->
          <div class="is-size-5 publication-authors">
            <span class="author-block">
              <a href="https://www.seas.upenn.edu/~jasonyma/">Jason Yecheng Ma</a><sup>1</sup>,</span>
            <span class="author-block">
              <a href="https://www.linkedin.com/in/jasyan/">Jason Yan</a><sup>1</sup>,
            </span>
            <span class="author-block">
              <a href="https://www.seas.upenn.edu/~dineshj/">Dinesh Jayaraman</a><sup>1</sup>,
            </span>
            <span class="author-block">
              <a href="https://obastani.github.io/">Osbert Bastani</a><sup>1</sup>
            </span>
          </div>
          <div class="is-size-5 publication-authors">
            <span class="author-block"><sup>1</sup>University of Pennsylvania</span>
          </div>

          <div class="column has-text-centered">
            <div class="publication-links">
              <!-- PDF Link. -->
              <span class="link-block">
                <a href=""
                   class="external-link button is-normal is-rounded is-dark">
                  <span class="icon">
                      <i class="ai ai-arxiv"></i>
                  </span>
                  <span>arXiv</span>
                </a>
              </span>
              <!-- PDF Link. -->
              <span class="link-block">
                <a href=""
                   class="external-link button is-normal is-rounded is-dark">
                  <span class="icon">
                      <i class="fas fa-file-pdf"></i>
                  </span>
                  <span>PDF</span>
                </a>
              </span>
              <!-- Code Link. -->
              <span class="link-block">
                <a href="https://github.com/JasonMa2016/GoFAR"
                   class="external-link button is-normal is-rounded is-dark">
                  <span class="icon">
                      <i class="fab fa-github"></i>
                  </span>
                  <span>Code</span>
                  </a>
              </span>

            </div>

          </div>
        </div>
      </div>
    </div>
  </div>
</section>

<section class="hero teaser">
  <div class="container is-max-desktop">
    <div class="hero-body">
      <div class="columns is-centered">
        <div class="column has-text-centered">
          <div class="content">
            <video autoplay muted loop width="550">
              <source src="./static/images/dclawturn_policies.mp4" type="video/mp4">
            </video>
            <h5>A challenging real-world dexterous manipulation task involving turning a valve to specified goal angles.</h5>
          </div>
        </div>
      </div>
    <h2 class="subtitle has-text-centered">
      GoFAR acquires complex manipulation behavior that successfully achieves distant goals; in contrast, baselines do not make meaningful progress on this task.
    </h2>
    </div>
  </div>
</section>

<section class="hero is-light is-small">
    <div class="hero-body">
      <div class="container is-max-desktop">
        <!-- Abstract. -->
      <div class="columns is-centered has-text-centered">
        <div class="column is-full-width">
          <h2 class="title is-3">Abstract</h2>
          <div class="content has-text-justified">
            <p>
                Offline goal-conditioned reinforcement learning (GCRL) promises general-purpose skill learning in the form of reaching diverse goals from purely offline datasets. We propose Goal-conditioned F-Advantage Regression (GoFAR), a novel regression-based offline GCRL algorithm derived from a state-occupancy matching perspective; the key intuition is that the goal-reaching task can be formulated as a state-occupancy matching problem between a dynamics-abiding imitator agent and an expert agent that directly teleports to the goal. In contrast to prior approaches, GoFAR does not require any hindsight relabeling and enjoys uninterleaved optimization for its value and policy networks. These distinct features confer GoFAR with much better offline performance and stability as well as statistical performance guarantee that is unattainable for prior methods. Furthermore, we demonstrate that GoFAR's training objectives can be re-purposed to learn an agent-independent goal-conditioned planner from purely offline source-domain data, which enables zero-shot transfer to new target domains. Through extensive experiments, we validate GoFAR's effectiveness in various problem settings and tasks, significantly outperforming prior state-of-art. Notably, on a real robotic dexterous manipulation task, while no other method makes meaningful progress, GoFAR acquires complex manipulation behavior that successfully accomplishes diverse goals.            </p>
          </div>
        </div>
    </div>
    <!--/ Abstract. -->

        </div>
    </div>
    </section>

<section class="section">
  <div class="container is-max-widescreen">
    <h2 class="title is-3">Goal-Conditioned F-Advantage Regression (GoFAR)</h2>
    <div class="columns is-centered">
      <div class="column is-three-quarters">
        <p>a novel regression-
4 based offline GCRL algorithm derived from a state-occupancy matching perspec-
5 tive; the key intuition is that the goal-reaching task can be formulated as a state-
6 occupancy matching problem between a dynamics-abiding imitator agent and an
7 expert agent that directly teleports to the goal (see Figure on the right.)</p>

        <br>
        <p>Leveraging this intuition, we pose a f-divergence regularized optimization problem over valid policy occupancy distributions.
           This optimization problem is difficult to solve; however, its <span style="font-weight:bold">dual problem</span> is surprisingly simple and tractable. Therefore, we solve the dual problem and obtain the optimal (resp. converged) value function.
            A transformation of this optimal value function can be shown to be the optimal importance weights, using which we train the policy via supervised regression.</p>
      </div>
      <div class="column is-one-quarter">
          <img src="./static/images/state-matching-concept-figure.png"/>
      </div>
    </div>
    <div class="columns is-centered has-text-centered">
      <div class="column is-full-width">
        <img src="./static/images/goal-concept-figure.png" width="1500"/>
      </div>
    </div>

    
    <h3 class="title is-4">Uninterleaved Optimization</h3>
    <p>GoFAR does not train its policy until its value function has converged. This confers uninterleaved optimization that is more stable than prior actor-critic based methods in the offline setting. This feature enables GoFAR to obtain <span style="font-weight:bold">state-of-art</span> performance on a variety of offline goal-conditioned continuous control tasks.</p>
    <div class="columns is-centered has-text-centered">
      <div class="column is-fullwidth">
        <img src="./static/images/offline-gcrl.png" width="1500"/>
      </div>
    </div>

    <!-- <h3 class="title is-4">Dyanmic Example Selection</h3>
    <p>In the case that a dataset, or a handful of examples, is available, we can provide weak supervision to the model by prompting the model with an example that is similar to the query task. We re-use the same Sentence RoBERTa model for this purpose, but instead we measure similarity between the query task against all possible examples.</p>
    <div class="columns is-centered has-text-centered">
      <div class="column is-fullwidth">
        <video autoplay muted loop width="60%">
          <source src="./static/images/dynamic-example-animated.mp4" type="video/mp4">
        </video>
      </div>
    </div> -->
  </div>
</section>

<!-- <section class="section" id="BibTeX">
  <div class="container is-max-desktop content">
    <h2 class="title">BibTeX</h2>
    <pre><code>@article{huang2022language,
      title={Language Models as Zero-Shot Planners: Extracting Actionable Knowledge for Embodied Agents},
      author={Huang, Wenlong and Abbeel, Pieter and Pathak, Deepak and Mordatch, Igor},
      journal={arXiv preprint arXiv:2201.07207},
      year={2022}
    }</code></pre>
  </div>
</section> -->


<footer class="footer">
  <div class="container">
    <div class="columns is-centered">
      <div class="content">
        <p>
          Website template is borrowed from <a
            href="https://github.com/nerfies/nerfies.github.io">Nerfies</a> and <a
            href="https://wenlong.page/language-planner/">Language Planner</a>.
        </p>
      </div>
    </div>
  </div>
</footer>

</body>
</html>